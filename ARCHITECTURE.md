# CEN455 Project Architecture

## System Architecture Diagram (Text Format)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CEN455 SECURE MQTT SYSTEM                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                      INSECURE SYSTEM                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   SENSOR     â”‚                              â”‚   ACTUATOR   â”‚
    â”‚ (Insecure)   â”‚                              â”‚ (Insecure)   â”‚
    â”‚              â”‚                              â”‚              â”‚
    â”‚ - Plaintext  â”‚                              â”‚ - No verify  â”‚
    â”‚ - No crypto  â”‚                              â”‚ - No replay  â”‚
    â”‚ - No auth    â”‚                              â”‚   protection â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                             â”‚
           â”‚ Plaintext                      Plaintext    â”‚
           â”‚ Messages                       Messages     â”‚
           â”‚                                             â”‚
           â–¼                                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              MQTT BROKER (Mosquitto)                    â”‚
    â”‚              - Port 1883                                â”‚
    â”‚              - No authentication                        â”‚
    â”‚              - Topic: home/door                         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ Can intercept,
                               â”‚ inject, replay,
                               â”‚ tamper
                               â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚    ATTACKER      â”‚
                      â”‚                  â”‚
                      â”‚ âœ… Eavesdrop     â”‚
                      â”‚ âœ… Inject        â”‚
                      â”‚ âœ… Replay        â”‚
                      â”‚ âœ… Tamper        â”‚
                      â”‚ âœ… Timing Attack â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                       SECURE SYSTEM                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   SENSOR (Secure)    â”‚                    â”‚  ACTUATOR (Secure)   â”‚
    â”‚                      â”‚                    â”‚                      â”‚
    â”‚ RSA Public Key       â”‚                    â”‚ RSA Private Key      â”‚
    â”‚ (Actuator's)         â”‚                    â”‚ (Own)                â”‚
    â”‚                      â”‚                    â”‚                      â”‚
    â”‚ DSA Private Key      â”‚                    â”‚ DSA Public Key       â”‚
    â”‚ (Own)                â”‚                    â”‚ (Sensor's)           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                                           â”‚
               â”‚ 1. Generate AES session key              â”‚
               â”‚ 2. Encrypt payload (AES-GCM)             â”‚
               â”‚ 3. Encrypt session key (RSA)             â”‚
               â”‚ 4. Sign message (DSA)                    â”‚
               â”‚ 5. Add counter (replay protection)       â”‚
               â”‚                                           â”‚
               â”‚         Encrypted Message                 â”‚
               â”‚         {                                 â”‚
               â”‚           enc_session_key,                â”‚
               â”‚           nonce,                          â”‚
               â”‚           ciphertext,                     â”‚
               â”‚           signature,                      â”‚
               â”‚           counter                         â”‚
               â”‚         }                                 â”‚
               â”‚                                           â”‚
               â–¼                                           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              MQTT BROKER (Mosquitto)                       â”‚
    â”‚              - Port 1883                                   â”‚
    â”‚              - ACL enabled (optional)                      â”‚
    â”‚              - Authentication ready                        â”‚
    â”‚              - Topic: home/door                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ Encrypted data
                              â”‚ Cannot decrypt
                              â”‚ Cannot forge
                              â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚    ATTACKER      â”‚
                     â”‚                  â”‚
                     â”‚ âŒ Eavesdrop     â”‚ (Encrypted)
                     â”‚ âŒ Inject        â”‚ (No valid sig)
                     â”‚ âŒ Replay        â”‚ (Counter check)
                     â”‚ âŒ Tamper        â”‚ (Integrity fail)
                     â”‚ âŒ Timing Attack â”‚ (Constant-time)
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

               â”‚                                           â”‚
               â”‚                                           â”‚ 6. Verify signature FIRST
               â”‚                                           â”‚ 7. Check counter (replay)
               â”‚                                           â”‚ 8. Decrypt session key (RSA)
               â”‚                                           â”‚ 9. Decrypt payload (AES-GCM)
               â”‚                                           â”‚ 10. Execute action
               â”‚                                           â”‚

```

## Message Flow - Secure System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SENSOR â”‚                                              â”‚ ACTUATOR â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜                                              â””â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”˜
     â”‚                                                       â”‚
     â”‚ 1. Generate sensor data                              â”‚
     â”‚    (door_open, counter=42, timestamp, etc.)          â”‚
     â”‚                                                       â”‚
     â”‚ 2. Generate fresh AES-256 session key                â”‚
     â”‚    session_key = random(32 bytes)                    â”‚
     â”‚                                                       â”‚
     â”‚ 3. Encrypt payload with AES-256-GCM                  â”‚
     â”‚    ciphertext = AES-GCM(session_key, plaintext)      â”‚
     â”‚    Associated Data: "topic|sensor_id"                â”‚
     â”‚                                                       â”‚
     â”‚ 4. Encrypt session key with Actuator's RSA-2048     â”‚
     â”‚    enc_key = RSA-OAEP(actuator_pubkey, session_key)  â”‚
     â”‚                                                       â”‚
     â”‚ 5. Sign with Sensor's DSA-2048 private key          â”‚
     â”‚    signature = DSA-Sign(sensor_privkey, data)        â”‚
     â”‚    data = nonce + ciphertext + counter + sensor_id   â”‚
     â”‚                                                       â”‚
     â”‚ 6. Publish to MQTT                                   â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚
     â”‚    {                                                  â”‚
     â”‚      sender: "sensor_001_secure",                     â”‚
     â”‚      enc_session_key: "...",                          â”‚
     â”‚      nonce: "...",                                    â”‚
     â”‚      ciphertext: "...",                               â”‚
     â”‚      signature: "...",                                â”‚
     â”‚      counter: 42,                                     â”‚
     â”‚      timestamp: 1700000000                            â”‚
     â”‚    }                                                  â”‚
     â”‚                                                       â”‚
     â”‚                                                       â”‚ 7. Verify DSA signature
     â”‚                                                       â”‚    (FIRST - prevent oracle)
     â”‚                                                       â”‚
     â”‚                                                       â”‚ 8. Check counter
     â”‚                                                       â”‚    if counter <= last_counter:
     â”‚                                                       â”‚        reject (replay!)
     â”‚                                                       â”‚
     â”‚                                                       â”‚ 9. Decrypt session key
     â”‚                                                       â”‚    key = RSA-Decrypt(priv, enc_key)
     â”‚                                                       â”‚
     â”‚                                                       â”‚ 10. Decrypt payload
     â”‚                                                       â”‚     plain = AES-GCM-Decrypt(key, ct)
     â”‚                                                       â”‚
     â”‚                                                       â”‚ 11. Execute action
     â”‚                                                       â”‚     perform_action(plain)
     â”‚                                                       â”‚
```

## Cryptographic Components

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CRYPTOGRAPHIC STACK                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Confidentiality Layer                               â”‚  â”‚
â”‚  â”‚  - AES-256-GCM (Symmetric Encryption)               â”‚  â”‚
â”‚  â”‚  - Fresh session key per message                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â–²                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Key Exchange Layer  â”‚                               â”‚  â”‚
â”‚  â”‚  - RSA-2048-OAEP     â”‚                               â”‚  â”‚
â”‚  â”‚  - Encrypts session keys                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â–²                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Authentication Layerâ”‚                               â”‚  â”‚
â”‚  â”‚  - DSA-2048          â”‚                               â”‚  â”‚
â”‚  â”‚  - Digital signaturesâ”‚                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â–²                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Replay Protection   â”‚                               â”‚  â”‚
â”‚  â”‚  - Monotonic countersâ”‚                               â”‚  â”‚
â”‚  â”‚  - State persistence â”‚                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â–²                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Timing Attack Defense                                â”‚  â”‚
â”‚  â”‚  - Constant-time comparison (hmac.compare_digest)    â”‚  â”‚
â”‚  â”‚  - No early exits in verification                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Attack Surface Comparison

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INSECURE SYSTEM                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Attack Vector          â”‚ Vulnerable? â”‚ Impact              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  Eavesdropping         â”‚    âœ… YES   â”‚ All data readable   â”‚
â”‚  Message Injection     â”‚    âœ… YES   â”‚ Full control        â”‚
â”‚  Replay Attack         â”‚    âœ… YES   â”‚ Repeat actions      â”‚
â”‚  Message Tampering     â”‚    âœ… YES   â”‚ Modify commands     â”‚
â”‚  Timing Attack         â”‚    âœ… YES   â”‚ Leak information    â”‚
â”‚                                                              â”‚
â”‚  Security Level: ğŸ”´ CRITICAL - No Protection                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SECURE SYSTEM                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Attack Vector          â”‚ Protected?  â”‚ Defense             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  Eavesdropping         â”‚    âœ… YES   â”‚ AES-256-GCM         â”‚
â”‚  Message Injection     â”‚    âœ… YES   â”‚ DSA-2048 Signatures â”‚
â”‚  Replay Attack         â”‚    âœ… YES   â”‚ Counter Verificationâ”‚
â”‚  Message Tampering     â”‚    âœ… YES   â”‚ AEAD + Signatures   â”‚
â”‚  Timing Attack         â”‚    âœ… YES   â”‚ Constant-time ops   â”‚
â”‚                                                              â”‚
â”‚  Security Level: ğŸŸ¢ SECURE - Full Protection                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     KEY HIERARCHY                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  SENSOR KEYS:                                                â”‚
â”‚    - sensor_rsa_pub.pem    (2048-bit, for key exchange)     â”‚
â”‚    - sensor_rsa_priv.pem   (2048-bit, PRIVATE!)             â”‚
â”‚    - sensor_dsa_pub.pem    (2048-bit, for verification)     â”‚
â”‚    - sensor_dsa_priv.pem   (2048-bit, PRIVATE!)             â”‚
â”‚                                                              â”‚
â”‚  ACTUATOR KEYS:                                              â”‚
â”‚    - actuator_rsa_pub.pem  (2048-bit, for key exchange)     â”‚
â”‚    - actuator_rsa_priv.pem (2048-bit, PRIVATE!)             â”‚
â”‚    - actuator_dsa_pub.pem  (2048-bit, for verification)     â”‚
â”‚    - actuator_dsa_priv.pem (2048-bit, PRIVATE!)             â”‚
â”‚                                                              â”‚
â”‚  SESSION KEYS:                                               â”‚
â”‚    - Generated fresh per message (AES-256, 32 bytes)        â”‚
â”‚    - Never reused                                            â”‚
â”‚    - Encrypted with RSA before transmission                  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## File Structure

```
cen455-secure-mqtt/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ insecure/              # Vulnerable system
â”‚   â”‚   â”œâ”€â”€ sensor.py          # Plaintext sensor
â”‚   â”‚   â”œâ”€â”€ actuator.py        # Unprotected actuator
â”‚   â”‚   â”œâ”€â”€ attacker.py        # Attack demonstrations
â”‚   â”‚   â””â”€â”€ timing_attack_demo.py  # Timing attack proof
â”‚   â”‚
â”‚   â”œâ”€â”€ secure/                # Protected system
â”‚   â”‚   â”œâ”€â”€ sensor_secure.py   # Encrypted sensor
â”‚   â”‚   â”œâ”€â”€ actuator_secure.py # Protected actuator
â”‚   â”‚   â””â”€â”€ attacker_secure_tests.py  # Failed attacks
â”‚   â”‚
â”‚   â”œâ”€â”€ common/                # Shared utilities
â”‚   â”‚   â”œâ”€â”€ crypto_utils.py    # Cryptographic functions
â”‚   â”‚   â”œâ”€â”€ mq_helpers.py      # MQTT helpers
â”‚   â”‚   â””â”€â”€ logger.py          # JSON logging
â”‚   â”‚
â”‚   â”œâ”€â”€ tests/                 # Unit tests
â”‚   â”‚   â”œâ”€â”€ test_crypto.py     # Crypto tests
â”‚   â”‚   â””â”€â”€ test_replay_protection.py  # Replay tests
â”‚   â”‚
â”‚   â”œâ”€â”€ metrics/               # Performance analysis
â”‚   â”‚   â”œâ”€â”€ collect_metrics.py # Data collection
â”‚   â”‚   â””â”€â”€ plot_results.py    # Visualization
â”‚   â”‚
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ generate_keys.py   # Key generation
â”‚
â”œâ”€â”€ broker/                    # MQTT broker
â”‚   â”œâ”€â”€ mosquitto.conf         # Broker config
â”‚   â”œâ”€â”€ aclfile                # Access control
â”‚   â””â”€â”€ docker-compose.yml     # Broker container
â”‚
â”œâ”€â”€ scripts/                   # Launch scripts
â”‚   â”œâ”€â”€ run-insecure.ps1       # Windows insecure demo
â”‚   â”œâ”€â”€ run-secure.ps1         # Windows secure demo
â”‚   â”œâ”€â”€ run-insecure.sh        # Linux insecure demo
â”‚   â””â”€â”€ run-secure.sh          # Linux secure demo
â”‚
â”œâ”€â”€ logs/                      # Output logs
â”œâ”€â”€ docs/                      # Generated reports
â”œâ”€â”€ README.md                  # Full documentation
â”œâ”€â”€ ALIYAREADME.md            # Quick guide
â””â”€â”€ PROJECT_SUMMARY.md        # This summary

```

## Performance Metrics (Expected)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PERFORMANCE COMPARISON                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Metric              â”‚ Insecure    â”‚ Secure      â”‚ Overhead â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  Avg Latency        â”‚  ~1-2 ms    â”‚  ~10-15 ms  â”‚  ~10x   â”‚
â”‚  Message Size       â”‚  ~200 bytes â”‚  ~800 bytes â”‚  ~4x    â”‚
â”‚  CPU Usage          â”‚  Low        â”‚  Medium     â”‚  Higher â”‚
â”‚  Attack Success     â”‚  100%       â”‚  0%         â”‚  -100%  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Security overhead is acceptable given the protection provided!
```

---

**Use this architecture in your report and presentation!**
